## 第1节 关系模型的好坏

- ER模型转换的关系是否就是最优的关系？

  不一定。

  关系模型潜在的问题：

  - 添加异常
  - 修改异常
  - 删除异常
  - 数据冗余

- 如何评价一个关系是好的还是坏的？

- 坏关系到好关系

  - 对关系模式进行优化
  - 主要优化技术：模式分解(比如ABCD用AB和BCD，或者ACD和ABD代替)

## 第2节 函数依赖的概念

- 函数依赖概念
  - 函数依赖可形式化表示为X->Y, 其中X and Y是属性集
  - 例如：rating->hrly_wage, AB->C
  - 如果对于关系实例r中的任意一对元组t1和t2，有t1.X = t2.X逻辑蕴含t1.Y = t2.Y，那么函数依赖X->Y在关系r中成立
  - 即关系r中给定两个元组，如果X属性值相等则Y的值也必须相等（X和Y是属性集）
  - 如果对关系R中的每个实例r，都满足函数依赖，则该函数依赖在关系R上成立。
    - 函数依赖必须由应用的语义所决定。
    - 对于给定关系R的某实例r，我们能判断它是否违反了某个函数依赖。
    - 但是不能仅仅根据一个满足函数依赖的实例来断定该函数依赖在关系模式R上成立。
- **函数依赖起到检测冗余是否存在的作用**

## 第3节 范式和Armstrong公理

### 范式

如果一个关系满足一种范式（BCNF，3NF等），就能判断该关系模式是否避免了某类问题。这样就能知道该关系是否需要分解。

#### 范式的分类

##### 第一范式（1NF）

- 每个属性都是原子属性
- 本质上所有关系都满足第一范式

##### 第二范式（2NF）

- 任何满足第二范式的关系满足第一范式
- 所有非主属性必须依赖于整个主码而不能依赖于主码的部分属性

### 函数依赖理论：Armstrong公理

从一个给定的函数依赖集推导出它所逻辑蕴含的所有函数依赖

![image-20200326213635217](https://tva1.sinaimg.cn/large/00831rSTly1gd7npz5hjij30ce05wgok.jpg)

![image-20200326213717015](https://tva1.sinaimg.cn/large/00831rSTly1gd7nqo5sblj30ja09cn3q.jpg)

## 第4节 函数依赖集

### 函数依赖和键

- 给定R(A,B,C)
  - A->ABC意味着A是一个键（码）



## 3NF

### 3NF的检查方法

- 检查函数依赖集F中的函数依赖，而不需要检查F$^+$
- 对于F中的每一个非平凡的函数依赖$\alpha\rightarrow\beta$，通过计算$\alpha$的属性闭包来判断，$\alpha$是否是关系的键
- 如果$\alpha$不是关系的键，则检查$\beta$是否属于关系R的候选键。



## BCNF和3NF的比较

- 将一个关系分解为符合3NF的关系集合：
  - 分解是无损的
  - 分解是保持函数依赖的
- 将一个关系分解为符合BCNF的关系集合：
  - 分解是无损的
  - 可能不保持函数依赖

### 设计目标

- BCNF
- 无损连接
- 保持函数依赖

如果不能得到这些

- 函数依赖的保持
- 使用3NF产生冗余