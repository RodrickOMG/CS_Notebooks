## 第一节 数据模型-层次模型

### 什么是数据模型，应描述哪些方面？

- **数据模型：** 是一个描述数据、数据联系、数据语义以及数据一致性约束的概念工具的集合，应包括：
  - **数据结构：** 由一组创建数据库的规则（定义数据库的结构）组成。
  - **数据操作：** 定义对数据进行的操作类型（包括更新和查找数据库中的数据以及修改数据库的结构）。
  - **约束条件：** 一组数据完整性定义规则，确保数据的正确性。

### 有哪些数据模型？

* 层次模型
* 网状模型
* 关系模型 

### 层次数据模型

- 利用“记录”（包含多个“属性”）和“双亲子女关系（PCR）”来描述应用的数据结构。

- **如何描述数据的结构？** 利用层次模型描述一个应用的数据结构，称为一个层次模式（型：数据库的结构），为“树”结构。
- **非层次的数据结构也可以描述吗？**
  - **采用副本**
    缺点：数据冗余（增加空间，一致性维护难）
  - **虚拟记录（优化方法）**
    缺点：指针操作增加开销

**层次模型有何优缺点：**
**优点：**

  - 数据模型比较简单，操作简单
- 对于实体间联系是固定的，且预先定义好的应用系统，性能较高
- 提供良好的完整性支持

**缺点：**

- 不适合于表示非层次性的联系
- 对插入和删除操作的限制比较多
- 查询子女节点必须通过双亲节点

## 第2节 数据模型-网状模型

### 什么是网状模型？

- 利用网状模型（记录&系）来描述一个应用，可以得到一个网状模式（数据库的结构）。是一个图（而非一个树）

### 网状模型如何描述数据的结构？

* 记录的表示（内部结构）
  记录，数据项（允许为多值和复合数据）
* 联系的表示（外部结构）
  系
  单属系、多属系
  首记录&属记录

### 网状模型的不同特点

- 它去掉了层次模型的两个限制：
  - 允许多个结点没有双亲结点；	
  - 允许结点有多个双亲结点。
- 它还允许两个结点之间有多种联系（复合联系）

### 网状模型有何优缺点？

**优点：**

 * 能够更为直接的描述现实世界
 * 具有良好的性能，存取效率较高

**缺点：**

* 其DDL语言极其复杂
* 数据独立性较差。由于实体间的联系本质上通过存取路径指示的，因此应用程序在访问数据时要指定存取路径。

## 第3节 数据模型-关系模型

### 什么是关系模型？

- 与层次、网状模型相比，具有数据结构简单（二维表格）、理论基础（关系运算）扎实的特点。

### 关系模型如何描述一个数据对象的（内部）结构？

- 采用关系（table）描述

### 如何理解属性的原子特性？

![image](https://imgconvert.csdnimg.cn/aHR0cHM6Ly90dmExLnNpbmFpbWcuY24vbGFyZ2UvMDA4MzFyU1RseTFnY21oYm13amt4ajMwbGwwOXpncWcuanBn?x-oss-process=image/format,png)

### 关系模型有哪些基本概念？

- 关系模型中，字段称为**属性**，字段值称为**属性值**，记录类型称为**关系模型**。关系模式名是R。记录称为**元组**，元组的集合称为**关系或实例**。
- 一般用大写字母A、B、C、……表示单个属性，用小写字母表示属性值。关系中属性的个数称为“元数”，元组的个数称为“**基数**”，有时也称关系为表格，元组为行，属性为列。
- 键由一个或几个属性组成，分为以下几种：
  - **超键：** 在关系中能唯一标识元组的属性集称为关系模式的超键。
  - **候选键：** 不含多余属性的超键称为候选键。
  - **主键：** 用户选作元组标识的一个候选键称为主键
  - **外键：** FK（Foreign Key），保持数据一致性、完整性，控制存储在外键表中的数据，使两张表形成关联。

## 第4节 关系运算-选择操作

### 什么是查询操作？

- 关系数据库的数据操作分为查询和更新两类。查询语句用于各种检索操作，更新操作用于插入、删除和修改等操作。
- 查询语言根据其理论基础的不同分成两大类：
  - a. 关系代数语言：查询操作是以集合操作为基础运算的DML语言。
  - b. 关系演算语言：查询操作是以谓词演算为基础运算的DML语言。

### 应该有哪些关系运算？各自有什么应用？

* 取关系的某些行
* 取关系的某些列
* 从多个关系取

### 关系代数有哪些基本运算？

关系代数的五个基本运算：关系代数是以关系为运算对象的一组高级运算的集合。关系定义为元数相同的元组的集合。集合中的元素为元组，关系代数中的操作可分为两类：

* 传统的集合操作：并、差、交、笛卡尔积。
* 扩充的关系操作：投影，选择，联接和自然联接，除。

### 关系代数的基本操作如何表达？

关系代数基本操作用简记为如下 符号：

- select：$\sigma$	(选择)

  ![image-20200606014738054](https://imgconvert.csdnimg.cn/aHR0cHM6Ly90dmExLnNpbmFpbWcuY24vbGFyZ2UvMDA3UzhaSWxseTFnZmh4ejB2cWF1ajMwc2MwZjY0ODIuanBn?x-oss-process=image/format,png)

- project：$\prod$	(投影)

  ![image-20200606014756378](https://imgconvert.csdnimg.cn/aHR0cHM6Ly90dmExLnNpbmFpbWcuY24vbGFyZ2UvMDA3UzhaSWxseTFnZmh4emNibHQxajMwc2MwZjZhaW4uanBn?x-oss-process=image/format,png)

- union：$\cup$	（并）

![image-20200606014814264](https://imgconvert.csdnimg.cn/aHR0cHM6Ly90dmExLnNpbmFpbWcuY24vbGFyZ2UvMDA3UzhaSWxseTFnZmh4em51OG8wajMweTQwaGlhbGwuanBn?x-oss-process=image/format,png)

- set difference：-	（差）

  ![image-20200606014833042](https://imgconvert.csdnimg.cn/aHR0cHM6Ly90dmExLnNpbmFpbWcuY24vbGFyZ2UvMDA3UzhaSWxseTFnZmh4enppeW00ajMweTQwZHl0Z2EuanBn?x-oss-process=image/format,png)

- Cartesian product：x	（笛卡尔积）

  ![image-20200606014853036](https://imgconvert.csdnimg.cn/aHR0cHM6Ly90dmExLnNpbmFpbWcuY24vbGFyZ2UvMDA3UzhaSWxseTFnZmh5MGJxeWNxajMwemUwZmtkcTkuanBn?x-oss-process=image/format,png)

### 什么是选择操作？

从关系中找出满足给定条件的所有元组称为选择。其中的条件是以逻辑表达式给出的，该逻辑表达式的值为真的元组被选取。
并选择操作形式化定义如下：$\sigma p(r)=\{ t|t\in r \space and\space p(t)\}$，其中r为关系模式，p为选择谓词，表明选择条件。

## 第5节 关系模型的完整性约束

### 什么是关系模型的完整性约束

**定义：** 是对关系的某种约束条件
**目的：** 用于保证关系数据库中数据的正确性和可靠性
**类型：** 1. 实体完整性规则 2. 参照完整性规则（引用完整性规则）3. 域完整性

### 实体完整性规则

规则要求：在任何关系的任何一个元组中，主键的值**不能为空值、也不可取重复的值。**
**目的：** 用于保证数据库表中的每一个元组都是唯一的。

### 域完整性规则

又称为用户定义完整性规则。
**规则要求：** 由用户根据实际情况，定义表中属性的取值范围。
**目的：** 用于保证给定字段中数据的有效性，即保证数据的取值在有效的范围内。

### 参照完整性规则

引用完整性规则
**规则要求：** 不引用不存在的实体
**目的：** 确保相关联的表中数据的一致。

## 第6节 投影操作、并操作

### 投影操作

从关系中挑选若干属性组成的新的关系称为投影。
经过投影运算能得到一个新关系，其关系所包含的属性往往比原关系少，或属性的排列顺序不同。
如果新关系中包含重复元组，则要删除重复元组。

### 投影操作的定义

投影操作形式化定义如下：

- 	形式化定义：$\prod A1,A2,...,Ak(r)$，其中r为关系模式，A1，A2为属性名。

### 并操作

设有两个关系R和S具有相同的关系模式，R和S的并是由属于R和S的元组构成的集合，记为$R\cup S$.

注意：R和S的元数相同。

### 并操作的定义

并操作形式化定义如下：

$r\cup s=\{ t|t\in r\space or \space t \in s\}$，其中r，s为具有相同属性个数且属性相同或兼容的关系模式。

## 第7节 基本运算的复合

### 什么是操作的复合

在关系代数运算中，可以灵活地把五种关系代数基本操作进行复合以满足实际应用需要这种经过有限次复合的式子称为关系代数表达式，能使用关系代数表达式表示各种数据查询操作。

### 基本运算可用复合使用吗？

可以，因为结果仍为关系（基本运算的查询能力已很强）

## 第8节 差操作、笛卡尔积操作

### 差操作

差操作形式化定义如下：

$r-s=\{ t|t\in r\space and \space t \notin s\}$，其中r，s为具有相同属性个数且属性相同或兼容的关系模式。

### 笛卡尔积操作

设有设关系R和S的元数分别为r和s。定义R和S的笛卡尔积是个（r+s）元的元组集合，每个元组的前r个分量（属性值）来自R的一个元组，后s个分量来自S的一个元组，记为RxS。

### 笛卡尔积操作定义

并笛卡尔积操作形式化定义如下：

$r\times s=\{ t\space q|t\in r\space and \space q \in s\}$，其中$R\cap S=\phi$

## 第9节 自然连接与外连接

### 什么是连接运算？

![image](https://imgconvert.csdnimg.cn/aHR0cHM6Ly90dmExLnNpbmFpbWcuY24vbGFyZ2UvMDA4MzFyU1RseTFnY21pZGUzaDJ2ajMwb24wYWNxYnEuanBn?x-oss-process=image/format,png)

### 连接运算类型

* 条件连接：从两个关系的笛卡尔积中选取属性间满足一定条件的元组
* 等值连接：从关系R与S的笛卡尔积中选取满足等值条件的元组
* 自然连接：也是等值连接，从两个关系的笛卡尔积中，选取公共属性满足等值条件的元组，但新关系不包含重复的属性
* 外连接：是在连接条件的某一边添加一个符号“*”，其连接结果是为符号所在边添加一个全部由“空值”组成的行。

### 外连接

![image](https://imgconvert.csdnimg.cn/aHR0cHM6Ly90dmExLnNpbmFpbWcuY24vbGFyZ2UvMDA4MzFyU1RseTFnY21pZWs4a3pvajMwaXkwYmZhaGYuanBn?x-oss-process=image/format,png)

## 第10节 实体集、联系集到关系模式的转换

### 三种可选方式

- 直接与用户交互，发现数据对象，形成关系模式集合
    (适合于原型开发方法，但需与用户不断交互，工作量巨大)
- 根据概念模型设计结果(E-R图&数据字典)，形成关系模式集合
    (方便且高效，避免与用户交互，适合与周期开发方法)
- 根据面向对象方法的分析结果（UML类图），形成关系模式集合
   （优点类同上一方法）

### 关系模式集合应当如何得到

* 直接与用户交互，发现数据对象，形成关系模式集合（适合于原型开发方法，但需与用户不断交互，工作量巨大）
* 根据概念模型设计结果（E-R图&数据字典），形成关系模式集合（方便且高效，避免与用户交互，适合周期开发方法）
* 根据面向对象方法的分析结果（UML类图），形成关系模式集合（优点类同上一方法）

### 如何实现实体集到关系模式的转换

* 将E-R图中的实体、实体的属性和实体之间的联系按照一定的转换规则转化为关系模式
* 一般E-R图中的一个实体转换为一个关系模式，实体的属性就是关系的属性，实体的键就是关系的键

### 实体集的转换

- 没有足够的属性以形成主码的实体集称为**弱实体集**。有主码的实体集称作**强实体集**。弱实体集必须与另一个称作标识或属主实体集的实体集关联才能有意义。每个弱实体集必须和一个标识实体关联；也就是说弱实体集存在依赖于标识实体集。我们称标识实体集拥有它所标识的弱实体集。

- #### 简单实体集的转换->新的关系模式:

	 属性集与主码:就是实体集的属性集与主码
	
- #### 弱实体集的转换->新的关系模式:
1. 属性集:弱实体集的属性集+主实体集的主码
2. 主码:主实体集的主码+弱实体集的分辩符
- #### 复杂实体集的转换->新的关系模式(1NF):
1. 属性集:包含实体集的所有简单属性，此外其复杂属性需逐层展开变换为多个简单属性
2. 主码:需根据唯一确定元组特征来确定
### 如何将联系集转换成关系模式

* 一个m：n联系可以转换为一个独立的关系模式，联系两端实体的键合并组成关系模式的键，新的关系模式的属性为两端实体的键（分别作为外键）和联系的属性。联系建为一新表，其主键由两个父实体的主键复合组成
![在这里插入图片描述](https://img-blog.csdnimg.cn/20200606153158446.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2RhaXl1Y2hlbmc4OA==,size_16,color_FFFFFF,t_70)
* 一个1:m或m：1的联系：在m端实体转换成的关系模式中加入1端实体类型的键（作为外键）和联系的属性，无需创建一个新的关系模式。 1 方主键出现在M方成为外键
![在这里插入图片描述](https://img-blog.csdnimg.cn/20200606152742504.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2RhaXl1Y2hlbmc4OA==,size_16,color_FFFFFF,t_70)
![在这里插入图片描述](https://img-blog.csdnimg.cn/20200606152951489.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2RhaXl1Y2hlbmc4OA==,size_16,color_FFFFFF,t_70)
* 一个一对一的联系：联系两端的实体类型转换成两个关系模式，在任意关系模式中加入另外一个关系模式的键（作为外键）和联系的属性。任意一方主键出现在另一方中，成外键
![在这里插入图片描述](https://img-blog.csdnimg.cn/20200606153101169.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2RhaXl1Y2hlbmc4OA==,size_16,color_FFFFFF,t_70)
#### 举例
![在这里插入图片描述](https://img-blog.csdnimg.cn/202006061540064.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2RhaXl1Y2hlbmc4OA==,size_16,color_FFFFFF,t_70)
### 多元联系如何转换

E-R在实际应用会遇到三元联系类型，一般按照与二元联系类型转换类似的规则进行转换：

- 若实体间联系是1:1:1，可以在三个实体类型转换成的三个关系模式中任意一个关系模式的属性中加入另两个关系模式的主键（作为外键）和联系类型的属性
 - 若实体间联系是1:1:N，则在N端实体类型转换成的关系模式中加入两个1端实体类型的主键（作为外键）和联系类型的属性。

* 若实体间联系是1:M：N，则将联系类型也转换成关系模式，其属性为M端和N端实体类型的主键（作为外键）加上联系类型的属性，而键为M端和N端实体键的组合。

- 若实体间联系是M：N：P，则将联系类型也转换成关系模式，其属性为三端实体类型的主键（作为外键）加上联系类型的属性而键为三端实体键的组合。



![在这里插入图片描述](https://img-blog.csdnimg.cn/20200606154125282.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2RhaXl1Y2hlbmc4OA==,size_16,color_FFFFFF,t_70)
项目(项目编号, 项目名称, 开工日期)
零件(零件号, 零件名, 规格)
供应商(供应商编号, 供应商名称, 供应商地址)
**供应(<u>项目编号</u>, <u>零件号</u>, <u>供应商编号</u>, 数量)**